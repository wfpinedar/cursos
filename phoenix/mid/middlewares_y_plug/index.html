<!doctype html>
<html lang="en">

<head>
        <title>Middlewares y Plug - Mis cursos</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        
        
        

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="../../../assets/css/darcula-highlight.min.css">

        <link rel="stylesheet" href="../../../assets/css/bootstrap.min.css">
        <link rel="stylesheet" href="../../../assets/css/dracula-ui.min.css">
        <link rel="stylesheet" href="../../../assets/css/mkdocs.min.css">

        
            <link  rel="icon" type="image/x-icon" href="../../../assets/img/favicon.ico">
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
                <script>hljs.initHighlightingOnLoad();</script>

</head>

<body class="drac-bg-black-secondary drac-text-grey-ternary drac-text drac-scrollbar-purple">

    <main class="d-flex">

        <!-- block sidebar -->
            <nav id="sidebar" class="sidebar drac-bg-black">
    <div class="custom-menu">
        <button type="button" id="sidebarCollapse" class="btn btn-primary">
            <i class="fa fa-bars"></i>
            <span class="sr-only">Menu</span>
        </button>
    </div>

    <div class="p-4">
        

        <div class="drac-text-center">
            
                <span class="drac-text drac-line-height drac-text-white">Mis cursos</span>
            
        </div>

        <div class="drac-box flex-column">
            <ul class="dot-ul">
                <li><div class="dot-li drac-bg-cyan"></div></li>
                <li><div class="dot-li drac-bg-green"></div></li>
                <li><div class="dot-li drac-bg-orange"></div></li>
                <li><div class="dot-li drac-bg-pink"></div></li>
                <li><div class="dot-li drac-bg-purple"></div></li>
                <li><div class="dot-li drac-bg-red"></div></li>
                <li><div class="dot-li drac-bg-yellow"></div></li>
            </ul>
        </div>

        <hr class="drac-divider" />

        <!-- block menu -->
        <ul class="mb-5 drac-list drac-list-none">
            
            <li class="drac-box">
                <a href="../../.."
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Introducción
                </a>
            </li>
            <li class="drac-box">
                <a href="../../.."
                    class="
                    drac-anchor btn-toggle d-inline-flex align-items-center border-0 drac-text-purple--hover collapsed"
                    data-bs-toggle="collapse" data-bs-target="#clojure-collapse" aria-expanded="false">
                    Clojure
                </a>
                <div class="collapse" id="clojure-collapse">
                    <ul class="mb-5 drac-list drac-list-none">
                            
    <li class="drac-box-ternary">
        <a href="../../../clojure/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Introducción
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../../../clojure/Junior/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Nivel Junior
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../../../clojure/mid/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Nivel Middle
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../../../clojure/senior/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Nivel Senior
        </a>
    </li>
                    </ul>
                </div>
            </li>
        </ul>
        <!-- endblock -->
    </div>
</nav>
        <!-- endblock -->

        <nav class="divider drac-bg-purple-cyan"></nav>

        <div class="content">
            <!-- block header -->
                <header>
    <nav class="navbar navbar-expand-xl drac-bg-purple">
        <div class="container-fluid">
            
            <button class="navbar-toggler w-100 text-center" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsMenu"
                aria-controls="navbarsMenu" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse flex-column ml-auto" id="navbarsMenu">
                <ul class="navbar-nav text-md-center">

                    <!-- block preview -->
                    <li class="nav-item">
                            
                    </li>
                    <!--  endblock -->

                    <!-- block search -->
                    <li class="nav-item"><div role="search" class="search-box">
	<form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
		<input type="text" name="q" class="drac-input drac-input-search drac-input-white drac-text-white drac-bg-black-secondary"
		placeholder="Search docs" title="Type search term here" />
	</form>
</div>
                    </li>
                    <!--  endblock -->

                    <!-- block source -->
                    <li class="nav-item">
                        
                            
                        
                    </li>
                    <!--  endblock -->

                </ul>
            </div>

        </div>
    </nav>
</header>
            <!-- endblock -->

            <!-- block content -->
                <section class="p-md-5 section-content">
    <article>
        <p><h1 id="middlewares-y-plug">Middlewares y Plug<a class="headerlink" href="#middlewares-y-plug" title="Permanent link">&para;</a></h1>
<h2 id="introduccion">Introducción<a class="headerlink" href="#introduccion" title="Permanent link">&para;</a></h2>
<p>Los middlewares son una parte esencial en cualquier aplicación web, ya que permiten el procesamiento de las peticiones antes de llegar al controlador. Esto nos da la oportunidad de realizar tareas como la autenticación, la validación de datos y la gestión de errores de manera centralizada y eficiente. En Phoenix Framework, los middlewares son implementados utilizando el módulo Plug, que nos proporciona una manera sencilla y robusta de crear nuestros propios middlewares.</p>
<h2 id="teoria">Teoría<a class="headerlink" href="#teoria" title="Permanent link">&para;</a></h2>
<p>Un middleware es una función que se ejecuta antes o después de que una petición llegue al controlador. Es una forma de encapsular lógica que puede ser aplicada a múltiples rutas dentro de una aplicación. Los middlewares son útiles para tareas como la autenticación, la gestión de sesiones, la compresión de respuestas, el registro de solicitudes, entre otras.</p>
<p>En Phoenix, los middlewares se ejecutan en una cadena, lo que significa que el resultado de uno se pasa al siguiente y así sucesivamente. Esto nos permite crear una lógica de procesamiento en capas para nuestras peticiones.</p>
<h2 id="palabras-clave-y-su-definicion">Palabras clave y su definición<a class="headerlink" href="#palabras-clave-y-su-definicion" title="Permanent link">&para;</a></h2>
<ul>
<li>Middleware: Función que se ejecuta antes o después de que una petición llegue al controlador.</li>
<li>Plug: Módulo en Phoenix Framework utilizado para crear middlewares.</li>
<li>Chain: Cadena de ejecución de middlewares, donde el resultado de uno se pasa al siguiente.</li>
</ul>
<h2 id="preguntas-de-repaso">Preguntas de repaso<a class="headerlink" href="#preguntas-de-repaso" title="Permanent link">&para;</a></h2>
<ol>
<li>¿Qué son los middlewares y para qué se utilizan?</li>
<li>¿Qué módulo se utiliza en Phoenix Framework para crear middlewares?</li>
<li>¿Cómo se ejecutan los middlewares en Phoenix?</li>
<li>¿Para qué tareas son útiles los middlewares?</li>
<li>¿Qué es una cadena de ejecución de middlewares?</li>
</ol>
<h2 id="ejemplos-de-codigo-en-phoenix-framework">Ejemplos de código en Phoenix Framework<a class="headerlink" href="#ejemplos-de-codigo-en-phoenix-framework" title="Permanent link">&para;</a></h2>
<p>Para crear un middleware en Phoenix, primero debemos crear un módulo Plug que implemente la función <code>call/2</code>. Esta función recibirá la petición y el siguiente middleware en la cadena como parámetros. A continuación, se muestra un ejemplo de un middleware de autenticación básico que verifica si el usuario está autenticado antes de permitir el acceso a una ruta determinada:</p>
<div class="codehilite"><pre><span></span><code><span class="n">defmodule</span> <span class="n">MyApp</span><span class="o">.</span><span class="n">AuthenticationMiddleware</span> <span class="n">do</span>
  <span class="kn">import</span><span class="w"> </span><span class="nn">Plug.Conn</span>
  <span class="n">alias</span> <span class="n">MyApp</span><span class="o">.</span><span class="n">Authentication</span>

  <span class="k">def</span><span class="w"> </span><span class="nf">init</span><span class="p">(</span><span class="n">_opts</span><span class="p">),</span> <span class="n">do</span><span class="p">:</span> <span class="o">%</span><span class="p">{}</span>

  <span class="k">def</span><span class="w"> </span><span class="nf">call</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">_opts</span><span class="p">)</span> <span class="n">do</span>
    <span class="k">if</span> <span class="n">Authentication</span><span class="o">.</span><span class="n">is_authenticated</span><span class="err">?</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span> <span class="n">do</span>
      <span class="n">conn</span>
    <span class="k">else</span>
      <span class="n">conn</span>
      <span class="o">|&gt;</span> <span class="n">put_status</span><span class="p">(</span><span class="mi">401</span><span class="p">)</span>
      <span class="o">|&gt;</span> <span class="n">send_resp</span><span class="p">(</span><span class="s2">&quot;No estás autenticado&quot;</span><span class="p">)</span>
      <span class="o">|&gt;</span> <span class="n">halt</span><span class="p">()</span>
    <span class="n">end</span>
  <span class="n">end</span>
<span class="n">end</span>
</code></pre></div>

<p>Una vez que tenemos nuestro middleware, podemos utilizarlo en nuestras rutas utilizando la macro <code>plug</code>, como se muestra a continuación:</p>
<div class="codehilite"><pre><span></span><code><span class="nv">defmodule</span><span class="w"> </span><span class="nv">MyApp</span>.<span class="nv">Router</span><span class="w"> </span><span class="k">do</span>
<span class="w">  </span><span class="nv">use</span><span class="w"> </span><span class="nv">MyApp</span>.<span class="nv">Web</span>,<span class="w"> </span>:<span class="nv">router</span>

<span class="w">  </span><span class="nv">plug</span><span class="w"> </span><span class="nv">MyApp</span>.<span class="nv">AuthenticationMiddleware</span><span class="w"> </span><span class="nv">when</span><span class="w"> </span><span class="nv">action</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span>[:<span class="k">show</span>,<span class="w"> </span>:<span class="nv">update</span>]

<span class="w">  </span><span class="nv">scope</span><span class="w"> </span><span class="s2">&quot;/users&quot;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nv">get</span><span class="w"> </span><span class="s2">&quot;/:id&quot;</span>,<span class="w"> </span><span class="nv">UserController</span>,<span class="w"> </span>:<span class="k">show</span>
<span class="w">    </span><span class="nv">put</span><span class="w"> </span><span class="s2">&quot;/:id&quot;</span>,<span class="w"> </span><span class="nv">UserController</span>,<span class="w"> </span>:<span class="nv">update</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</code></pre></div>

<p>En este ejemplo, nuestro middleware se ejecutará antes de las acciones <code>show</code> y <code>update</code> del controlador <code>UserController</code>.</p>
<h2 id="ejercicios-practicos-con-instrucciones-claras">Ejercicios prácticos con instrucciones claras<a class="headerlink" href="#ejercicios-practicos-con-instrucciones-claras" title="Permanent link">&para;</a></h2>
<ol>
<li>Crea un nuevo módulo Plug que implemente una función <code>call/2</code> y que imprima un mensaje en la consola cada vez que se le llame.</li>
<li>Utiliza este middleware en una de tus rutas y verifica que el mensaje se imprima correctamente.</li>
<li>Crea un nuevo middleware que verifique si el usuario tiene un rol específico antes de permitir el acceso a una ruta determinada.</li>
<li>Utiliza este middleware en una ruta de tu aplicación y comprueba que solo los usuarios con el rol adecuado puedan acceder a ella.</li>
</ol>
<h2 id="consejos-o-mejores-practicas">Consejos o mejores prácticas<a class="headerlink" href="#consejos-o-mejores-practicas" title="Permanent link">&para;</a></h2>
<ul>
<li>Utiliza middlewares para tareas que se aplican a múltiples rutas en tu aplicación.</li>
<li>Crea middlewares reutilizables para tareas comunes como la autenticación y la gestión de sesiones.</li>
<li>Asegúrate de que los middlewares se ejecuten en el orden adecuado en la cadena, ya que esto puede afectar su funcionamiento.</li>
<li>Utiliza la documentación de Plug para conocer todas las opciones y funciones disponibles para crear middlewares en Phoenix.</li>
</ul></p>
    </article>
</section>
            <!-- endblock -->

            <!-- block footer -->
                <footer>
    <div class="d-flex flex-sm-row justify-content-between py-2 border-top drac-text-black drac-bg-cyan-green">
        <a href="https://github.com/dracula/mkdocs" target="_blank" style="padding-left: 1%;"
            class="footer-text drac-anchor drac-text-black drac-text-purple--hover">
            Made with Dracula Theme for MkDocs
        </a>
    </div>
</footer>
            <!-- endblock -->
        </div>

    </main>

        <script>var base_url = '../../..';</script>
        <script src="../../../assets/js/jquery-3.3.1.slim.min.js"></script>
        <script src="../../../assets/js/bootstrap.bundle.min.js"></script>
        <script src="../../../assets/js/mkdocs.js"></script>
			<script src="../../../search/main.js" defer></script>

</body>

</html>