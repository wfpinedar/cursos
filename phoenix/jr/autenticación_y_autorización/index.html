<!doctype html>
<html lang="en">

<head>
        <title>Autenticación y Autorización en Phoenix - Mis cursos</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        
        
        

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="../../../assets/css/darcula-highlight.min.css">

        <link rel="stylesheet" href="../../../assets/css/bootstrap.min.css">
        <link rel="stylesheet" href="../../../assets/css/dracula-ui.min.css">
        <link rel="stylesheet" href="../../../assets/css/mkdocs.min.css">

        
            <link  rel="icon" type="image/x-icon" href="../../../assets/img/favicon.ico">
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
                <script>hljs.initHighlightingOnLoad();</script>

</head>

<body class="drac-bg-black-secondary drac-text-grey-ternary drac-text drac-scrollbar-purple">

    <main class="d-flex">

        <!-- block sidebar -->
            <nav id="sidebar" class="sidebar drac-bg-black">
    <div class="custom-menu">
        <button type="button" id="sidebarCollapse" class="btn btn-primary">
            <i class="fa fa-bars"></i>
            <span class="sr-only">Menu</span>
        </button>
    </div>

    <div class="p-4">
        

        <div class="drac-text-center">
            
                <span class="drac-text drac-line-height drac-text-white">Mis cursos</span>
            
        </div>

        <div class="drac-box flex-column">
            <ul class="dot-ul">
                <li><div class="dot-li drac-bg-cyan"></div></li>
                <li><div class="dot-li drac-bg-green"></div></li>
                <li><div class="dot-li drac-bg-orange"></div></li>
                <li><div class="dot-li drac-bg-pink"></div></li>
                <li><div class="dot-li drac-bg-purple"></div></li>
                <li><div class="dot-li drac-bg-red"></div></li>
                <li><div class="dot-li drac-bg-yellow"></div></li>
            </ul>
        </div>

        <hr class="drac-divider" />

        <!-- block menu -->
        <ul class="mb-5 drac-list drac-list-none">
            
            <li class="drac-box">
                <a href="../../.."
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Introducción
                </a>
            </li>
            <li class="drac-box">
                <a href="../../.."
                    class="
                    drac-anchor btn-toggle d-inline-flex align-items-center border-0 drac-text-purple--hover collapsed"
                    data-bs-toggle="collapse" data-bs-target="#clojure-collapse" aria-expanded="false">
                    Clojure
                </a>
                <div class="collapse" id="clojure-collapse">
                    <ul class="mb-5 drac-list drac-list-none">
                            
    <li class="drac-box-ternary">
        <a href="../../../clojure/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Introducción
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../../../clojure/Junior/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Nivel Junior
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../../../clojure/mid/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Nivel Middle
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../../../clojure/senior/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Nivel Senior
        </a>
    </li>
                    </ul>
                </div>
            </li>
            <li class="drac-box">
                <a href="../../.."
                    class="
                    drac-anchor btn-toggle d-inline-flex align-items-center border-0 drac-text-purple--hover collapsed"
                    data-bs-toggle="collapse" data-bs-target="#elixir-collapse" aria-expanded="false">
                    Elixir
                </a>
                <div class="collapse" id="elixir-collapse">
                    <ul class="mb-5 drac-list drac-list-none">
                            
    <li class="drac-box-ternary">
        <a href="../../../elixir/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Introducción
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../../../elixir/jr/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Nivel Junior
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../../../elixir/mid/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Nivel Middle
        </a>
    </li>
                            
    <li class="drac-box-ternary">
        <a href="../../../elixir/sr/"
            class="
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Nivel Senior
        </a>
    </li>
                    </ul>
                </div>
            </li>
        </ul>
        <!-- endblock -->
    </div>
</nav>
        <!-- endblock -->

        <nav class="divider drac-bg-purple-cyan"></nav>

        <div class="content">
            <!-- block header -->
                <header>
    <nav class="navbar navbar-expand-xl drac-bg-purple">
        <div class="container-fluid">
            
            <button class="navbar-toggler w-100 text-center" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsMenu"
                aria-controls="navbarsMenu" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse flex-column ml-auto" id="navbarsMenu">
                <ul class="navbar-nav text-md-center">

                    <!-- block preview -->
                    <li class="nav-item">
                            
                    </li>
                    <!--  endblock -->

                    <!-- block search -->
                    <li class="nav-item"><div role="search" class="search-box">
	<form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
		<input type="text" name="q" class="drac-input drac-input-search drac-input-white drac-text-white drac-bg-black-secondary"
		placeholder="Search docs" title="Type search term here" />
	</form>
</div>
                    </li>
                    <!--  endblock -->

                    <!-- block source -->
                    <li class="nav-item">
                        
                            
                        
                    </li>
                    <!--  endblock -->

                </ul>
            </div>

        </div>
    </nav>
</header>
            <!-- endblock -->

            <!-- block content -->
                <section class="p-md-5 section-content">
    <article>
        <p><h1 id="autenticacion-y-autorizacion-en-phoenix">Autenticación y Autorización en Phoenix<a class="headerlink" href="#autenticacion-y-autorizacion-en-phoenix" title="Permanent link">&para;</a></h1>
<h2 id="descripcion-del-modulo">Descripción del módulo:<a class="headerlink" href="#descripcion-del-modulo" title="Permanent link">&para;</a></h2>
<p>En este módulo aprenderemos cómo implementar la autenticación y autorización en una aplicación Phoenix utilizando Guardian, una librería de autenticación y autorización para Elixir. La autenticación y autorización son dos aspectos fundamentales en cualquier aplicación web moderna, ya que permiten controlar el acceso a recursos y garantizar la seguridad de los datos.</p>
<h2 id="explicacion-teorica">Explicación teórica:<a class="headerlink" href="#explicacion-teorica" title="Permanent link">&para;</a></h2>
<p>La autenticación se refiere al proceso de verificar la identidad de un usuario, es decir, comprobar que el usuario es quien dice ser. Por otro lado, la autorización se encarga de determinar qué recursos o acciones tiene permitido un usuario una vez que ha sido autenticado. Ambos conceptos son esenciales para garantizar la seguridad de una aplicación y proteger los datos de los usuarios.</p>
<p>En el contexto de una aplicación Phoenix, la autenticación y autorización se pueden implementar utilizando una combinación de Guardian, una librería de autenticación y autorización para Elixir, y Plug, un módulo de Phoenix que permite la creación de middlewares para el manejo de peticiones HTTP.</p>
<h2 id="palabras-clave-y-su-definicion">Palabras clave y su definición:<a class="headerlink" href="#palabras-clave-y-su-definicion" title="Permanent link">&para;</a></h2>
<ul>
<li>Autenticación: Proceso de verificación de la identidad de un usuario.</li>
<li>Autorización: Determinación de los recursos y acciones permitidos a un usuario.</li>
<li>Guardian: Librería de autenticación y autorización para Elixir.</li>
<li>Plug: Módulo de Phoenix para la creación de middlewares.</li>
<li>JWT: JSON Web Token, un estándar para la creación de tokens de seguridad.</li>
</ul>
<h2 id="preguntas-de-repaso">Preguntas de repaso:<a class="headerlink" href="#preguntas-de-repaso" title="Permanent link">&para;</a></h2>
<ol>
<li>¿Cuál es la diferencia entre autenticación y autorización?</li>
<li>¿Qué librería se utiliza en Phoenix para implementar la autenticación y autorización?</li>
<li>¿Qué es un JWT y para qué se utiliza en la autenticación?</li>
<li>¿Qué es un middleware y cómo se utiliza en Phoenix?</li>
</ol>
<h2 id="ejemplos-de-codigo-en-phoenix-framework">Ejemplos de código en Phoenix Framework:<a class="headerlink" href="#ejemplos-de-codigo-en-phoenix-framework" title="Permanent link">&para;</a></h2>
<p>A continuación, se muestra un ejemplo de cómo se puede implementar la autenticación y autorización en una aplicación Phoenix utilizando Guardian:</p>
<p>En el archivo <code>router.ex</code>, se define un pipeline para la autenticación que utilizará Guardian:</p>
<div class="codehilite"><pre><span></span><code><span class="n">pipeline</span><span class="w"> </span><span class="ss">:auth</span><span class="w"> </span><span class="k">do</span>
<span class="w">  </span><span class="n">plug</span><span class="w"> </span><span class="nc">Guardian.Plug.VerifyHeader</span>
<span class="w">  </span><span class="n">plug</span><span class="w"> </span><span class="nc">Guardian.Plug.LoadResource</span>
<span class="w">  </span><span class="n">plug</span><span class="w"> </span><span class="nc">Guardian.Plug.EnsureAuthenticated</span>
<span class="k">end</span>
</code></pre></div>

<p>Luego, en el archivo <code>controllers/session_controller.ex</code>, se pueden definir las acciones para el inicio de sesión y el cierre de sesión:</p>
<div class="codehilite"><pre><span></span><code><span class="kd">def</span><span class="w"> </span><span class="n">create</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="w"> </span><span class="p">%{</span><span class="s2">&quot;email&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;password&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">password</span><span class="p">})</span><span class="w"> </span><span class="k">do</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="nc">MyApp.Authenticator</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">)</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="p">{</span><span class="ss">:ok</span><span class="p">,</span><span class="w"> </span><span class="n">user</span><span class="p">}</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">      </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">MyApp.Guardian</span><span class="o">.</span><span class="n">encode_and_sign</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
<span class="w">      </span><span class="n">conn</span>
<span class="w">      </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">put_status</span><span class="p">(</span><span class="ss">:created</span><span class="p">)</span>
<span class="w">      </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">render</span><span class="p">(</span><span class="nc">MyApp.SessionView</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;token.json&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">token</span><span class="p">:</span><span class="w"> </span><span class="n">token</span><span class="p">)</span>

<span class="w">    </span><span class="p">{</span><span class="ss">:error</span><span class="p">,</span><span class="w"> </span><span class="n">reason</span><span class="p">}</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">      </span><span class="n">conn</span>
<span class="w">      </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">put_status</span><span class="p">(</span><span class="ss">:unauthorized</span><span class="p">)</span>
<span class="w">      </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">render</span><span class="p">(</span><span class="nc">MyApp.SessionView</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;error.json&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">reason</span><span class="p">:</span><span class="w"> </span><span class="n">reason</span><span class="p">)</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>

<span class="kd">def</span><span class="w"> </span><span class="n">delete</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span><span class="w"> </span><span class="n">_params</span><span class="p">)</span><span class="w"> </span><span class="k">do</span>
<span class="w">  </span><span class="n">conn</span>
<span class="w">  </span><span class="o">|&gt;</span><span class="w"> </span><span class="nc">Guardian.Plug</span><span class="o">.</span><span class="n">sign_out</span><span class="p">()</span>
<span class="w">  </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">put_status</span><span class="p">(</span><span class="ss">:ok</span><span class="p">)</span>
<span class="w">  </span><span class="o">|&gt;</span><span class="w"> </span><span class="n">render</span><span class="p">(</span><span class="nc">MyApp.SessionView</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;delete.json&quot;</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>

<p>Y finalmente, en el archivo <code>models/user.ex</code>, se puede definir la función <code>generate_token</code> para generar el token JWT correspondiente al usuario:</p>
<div class="codehilite"><pre><span></span><code><span class="kd">def</span><span class="w"> </span><span class="n">generate_token</span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="k">do</span>
<span class="w">  </span><span class="p">%{</span>
<span class="w">    </span><span class="s2">&quot;id&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;name&quot;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="n">name</span>
<span class="w">  </span><span class="p">}</span>
<span class="k">end</span>
</code></pre></div>

<h2 id="ejercicios-practicos-con-instrucciones-claras">Ejercicios prácticos con instrucciones claras:<a class="headerlink" href="#ejercicios-practicos-con-instrucciones-claras" title="Permanent link">&para;</a></h2>
<ol>
<li>Crea una nueva aplicación Phoenix utilizando el comando <code>mix phx.new my_app</code>.</li>
<li>Añade la librería Guardian a tu proyecto editando el archivo <code>mix.exs</code> y ejecutando el comando <code>mix deps.get</code>.</li>
<li>Crea un nuevo endpoint para el inicio de sesión en el archivo <code>router.ex</code> utilizando el pipeline <code>:auth</code> y la acción <code>create</code> del controlador de sesión.</li>
<li>Implementa la función <code>authenticate</code> en el módulo <code>MyApp.Authenticator</code> para verificar las credenciales del usuario y devolver un token JWT válido.</li>
<li>Añade una ruta para el cierre de sesión en el archivo <code>router.ex</code> utilizando la acción <code>delete</code> del controlador de sesión.</li>
<li>Implementa la función <code>generate_token</code> en el modelo <code>User</code> para generar el token JWT correspondiente al usuario.</li>
<li>Prueba tu implementación utilizando herramientas como Postman o cURL para realizar peticiones HTTP al endpoint de inicio de sesión y de cierre de sesión.</li>
<li>Modifica tu aplicación para que solo los usuarios autenticados puedan acceder a ciertas rutas utilizando el pipeline <code>:auth</code>.</li>
</ol>
<h2 id="consejos-o-mejores-practicas">Consejos o mejores prácticas:<a class="headerlink" href="#consejos-o-mejores-practicas" title="Permanent link">&para;</a></h2>
<ul>
<li>Utiliza un middleware como Guardian para manejar la autenticación y autorización en tu aplicación Phoenix, en lugar de implementar tu propia solución desde cero.</li>
<li>Asegúrate de implementar las medidas de seguridad adecuadas, como el encriptado de contraseñas, para proteger las credenciales de los usuarios.</li>
<li>Utiliza tokens JWT en lugar de sesiones para el manejo de la autenticación, ya que son más seguros y escalables.</li>
<li>Realiza pruebas exhaustivas para asegurarte de que tu sistema de autenticación y autorización funciona correctamente y no presenta vulnerabilidades.</li>
</ul></p>
    </article>
</section>
            <!-- endblock -->

            <!-- block footer -->
                <footer>
    <div class="d-flex flex-sm-row justify-content-between py-2 border-top drac-text-black drac-bg-cyan-green">
        <a href="https://github.com/dracula/mkdocs" target="_blank" style="padding-left: 1%;"
            class="footer-text drac-anchor drac-text-black drac-text-purple--hover">
            Made with Dracula Theme for MkDocs
        </a>
    </div>
</footer>
            <!-- endblock -->
        </div>

    </main>

        <script>var base_url = '../../..';</script>
        <script src="../../../assets/js/jquery-3.3.1.slim.min.js"></script>
        <script src="../../../assets/js/bootstrap.bundle.min.js"></script>
        <script src="../../../assets/js/mkdocs.js"></script>
			<script src="../../../search/main.js" defer></script>

</body>

</html>